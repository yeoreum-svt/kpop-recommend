<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>æ°—åˆ†ã¨ã‚¸ãƒ£ãƒ³ãƒ«ã§é¸ã¶K-POP</title>
  <style>
    body {
      font-family: "Noto Sans JP", sans-serif;
      background: #fdfcfa;
      color: #444;
      padding: 20px;
      max-width: 600px;
      margin: auto;
    }
    h2 {
      color: #c2798b;
      font-size: 1.5em;
      margin-bottom: 1em;
    }
    .section-title {
      font-weight: bold;
      color: #a0526d;
      margin-top: 1.2em;
      margin-bottom: 0.5em;
    }
    #feelings, #genres {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 20px;
    }
    #feelings button, #genres button {
      padding: 10px 18px;
      border-radius: 24px;
      background: #fff;
      border: 1.5px solid #e3cfcf;
      cursor: pointer;
      font-size: 0.95em;
      transition: all 0.3s ease;
      box-shadow: 1px 1px 3px rgba(0,0,0,0.05);
    }
    #feelings button.selected, #genres button.selected {
      background-color: #ffe3ec;
      color: #c2798b;
      border-color: #c2798b;
    }
    @keyframes shake {
      0% { transform: translateX(0); }
      20% { transform: translateX(-4px); }
      40% { transform: translateX(4px); }
      60% { transform: translateX(-4px); }
      80% { transform: translateX(4px); }
      100% { transform: translateX(0); }
    }
    #feelings button.shake, #genres button.shake {
      animation: shake 0.3s;
    }
    .recommend-btn {
      display: block;
      margin: 30px auto 0;
      padding: 12px 26px;
      font-size: 1.05em;
      font-weight: 600;
      background: linear-gradient(135deg, #ffd1dc, #ffe4e1);
      color: #a0526d;
      border: none;
      border-radius: 30px;
      box-shadow: 0 4px 10px rgba(255, 182, 193, 0.3);
      cursor: pointer;
      transition: all 0.3s ease;
    }
    .recommend-btn:hover {
      transform: scale(1.03);
    }
    #result {
      margin-top: 30px;
      background: #fffdfd;
      border: 1px solid #f0e5e5;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 2px 2px 10px rgba(0,0,0,0.03);
    }
    iframe {
      margin-top: 10px;
      border-radius: 8px;
    }
    em {
      color: #777;
      font-style: italic;
    }
  </style>
</head>
<body>
  <h2>ğŸ§ ä»Šã®æ°—åˆ†ã¨ã‚¸ãƒ£ãƒ³ãƒ«ã§é¸ã¶ã€ã‚ãªãŸã«ã´ã£ãŸã‚Šã®K-POP</h2>
  <div class="section-title">ä»Šã®æ°—åˆ†ã‚’é¸ã‚“ã§ãã ã•ã„ï¼ˆæœ€å¤§2ã¤ï¼‰</div>
  <div id="feelings">
    <button onclick="selectFeeling(this, 'å¤±æ‹')">å¤±æ‹</button>
    <button onclick="selectFeeling(this, 'ä¸å®‰')">ä¸å®‰</button>
    <button onclick="selectFeeling(this, 'å­¤ç‹¬')">å­¤ç‹¬</button>
    <button onclick="selectFeeling(this, 'æœŸå¾…')">æœŸå¾…</button>
    <button onclick="selectFeeling(this, 'é’æ˜¥')">é’æ˜¥</button>
    <button onclick="selectFeeling(this, 'å¸Œæœ›')">å¸Œæœ›</button>
    <button onclick="selectFeeling(this, 'æ´»åŠ›')">æ´»åŠ›</button>
    <button onclick="selectFeeling(this, 'è‡ªä¿¡')">è‡ªä¿¡</button>
    <button onclick="selectFeeling(this, 'æ±ºæ„')">æ±ºæ„</button>
    <button onclick="selectFeeling(this, 'æŒ‘æˆ¦')">æŒ‘æˆ¦</button>
  </div>

  <div class="section-title">ã©ã‚“ãªæ›²ãŒå¥½ãã§ã™ã‹ï¼Ÿï¼ˆ1ã¤ã ã‘é¸æŠï¼‰</div>
  <div id="genres">
    <button onclick="selectGenre(this, 'ãƒãƒ©ãƒ¼ãƒ‰')">ãƒãƒ©ãƒ¼ãƒ‰</button>
    <button onclick="selectGenre(this, 'ãƒ­ãƒƒã‚¯')">ãƒ­ãƒƒã‚¯</button>
    <button onclick="selectGenre(this, 'ãƒãƒƒãƒ—')">ãƒãƒƒãƒ—</button>
    <button onclick="selectGenre(this, 'ãƒ’ãƒƒãƒ—ãƒ›ãƒƒãƒ—')">ãƒ’ãƒƒãƒ—ãƒ›ãƒƒãƒ—</button>
    <button onclick="selectGenre(this, 'ã‚¸ãƒ£ã‚º')">ã‚¸ãƒ£ã‚º</button>
    <button onclick="selectGenre(this, 'R&B')">R&B</button>
    <button onclick="selectGenre(this, 'ãƒ€ãƒ³ã‚¹')">ãƒ€ãƒ³ã‚¹</button>
    <button onclick="selectGenre(this, 'ã‚¨ãƒ¬ã‚¯ãƒˆãƒ­')">ã‚¨ãƒ¬ã‚¯ãƒˆãƒ­</button>
  </div>

  <button class="recommend-btn" onclick="recommendSong()">ğŸŒ· ãŠã™ã™ã‚è¡¨ç¤º</button>

  <div id="result" style="display:none;">
    <h3 id="title"></h3>
    <p id="bpm"></p>
    <p><em id="lyrics"></em></p>
    <div id="video"></div>
  </div>

  <script>
    // æ„Ÿæƒ…ã‚¹ã‚³ã‚¢
    const emotionScores = {
      "å¤±æ‹": 10, "ä¸å®‰": 20, "å­¤ç‹¬": 25, "æœŸå¾…": 40, "é’æ˜¥": 50, "å¸Œæœ›": 60, "æ´»åŠ›": 70, "è‡ªä¿¡": 75, "æ±ºæ„": 85, "æŒ‘æˆ¦": 90
    };
    // æ›²ãƒ‡ãƒ¼ã‚¿ã«genreå±æ€§ã‚’è¿½åŠ ï¼ˆè¤‡æ•°å¯ã€ä¸»è¦ã‚¸ãƒ£ãƒ³ãƒ«ã§OKï¼‰
    const songs = [
      {
        title: "Hug - SEVENTEEN",
        score: 10,
        genre: ["ãƒãƒ©ãƒ¼ãƒ‰"],
        bpm: "72 BPM",
        lyrics: "ãã°ã«ã„ã¦ãã‚Œã‚‹ã ã‘ã§ã‚ˆã‹ã£ãŸ â€” Just being by your side was enough",
        youtube: "https://www.youtube.com/embed/r6H0L_6Nehg"
      },
      {
        title: "Don't Wanna Cry - SEVENTEEN",
        score: 15,
        genre: ["ãƒãƒ©ãƒ¼ãƒ‰", "ãƒ€ãƒ³ã‚¹"],
        bpm: "122 BPM",
        lyrics: "å›ã‚’å¤±ã†ã®ãŒæ€–ã‹ã£ãŸ â€” I was afraid of losing you",
        youtube: "https://www.youtube.com/embed/9M7k9ZV67c0"
      },
      {
        title: "Smile Flower - SEVENTEEN",
        score: 25,
        genre: ["ãƒãƒ©ãƒ¼ãƒ‰"],
        bpm: "100 BPM",
        lyrics: "ã©ã‚“ãªå­£ç¯€ã‚‚åƒ•ãŸã¡ã¯å…±ã« â€” No matter the season, we are together",
        youtube: "https://www.youtube.com/embed/F6YvyFUjz50"
      },
      {
        title: "Run to You - SEVENTEEN",
        score: 35,
        genre: ["ãƒãƒƒãƒ—", "ãƒ€ãƒ³ã‚¹"],
        bpm: "108 BPM",
        lyrics: "ä»Šã™ãå›ã®å…ƒã¸èµ°ã‚‹ã‚ˆ â€” Iâ€™ll run to you now",
        youtube: "https://www.youtube.com/embed/cFVwSKW2ySA"
      },
      {
        title: "Lean On Me - SEVENTEEN",
        score: 40,
        genre: ["ãƒãƒ©ãƒ¼ãƒ‰", "R&B"],
        bpm: "95 BPM",
        lyrics: "å¯„ã‚Šã‹ã‹ã£ã¦ã‚‚ã„ã„ã‚ˆ â€” You can lean on me",
        youtube: "https://www.youtube.com/embed/QZRXNIhb_UQ"
      },
      {
        title: "Yawn - SEVENTEEN",
        score: 45,
        genre: ["ãƒãƒ©ãƒ¼ãƒ‰", "ã‚¸ãƒ£ã‚º"],
        bpm: "85 BPM",
        lyrics: "çœ æ°—ã«åŒ…ã¾ã‚Œã¦æ€ã„å‡ºã™ â€” Wrapped in drowsiness, I remember",
        youtube: "https://www.youtube.com/embed/zMb9IYM2mrY"
      },
      {
        title: "All My Love - SEVENTEEN",
        score: 50,
        genre: ["ãƒãƒ©ãƒ¼ãƒ‰", "ãƒãƒƒãƒ—"],
        bpm: "92 BPM",
        lyrics: "å…¨ã¦ã®æ„›ã‚’å›ã« â€” All my love for you",
        youtube: "https://www.youtube.com/embed/62WxBUmGUd0"
      },
      {
        title: "To You - SEVENTEEN",
        score: 55,
        genre: ["ãƒãƒƒãƒ—"],
        bpm: "110 BPM",
        lyrics: "å›ã®ã¨ã“ã‚ã¸å‘ã‹ã† â€” Heading to you",
        youtube: "https://www.youtube.com/embed/0MvzN8CrUE0"
      },
      {
        title: "Second Life - SEVENTEEN",
        score: 60,
        genre: ["R&B", "ãƒãƒ©ãƒ¼ãƒ‰"],
        bpm: "89 BPM",
        lyrics: "äºŒåº¦ç›®ã®äººç”Ÿã‚’å›ã¨ â€” A second life with you",
        youtube: "https://www.youtube.com/embed/yKUuK77Tzsg"
      },
      {
        title: "Us, Again - SEVENTEEN",
        score: 65,
        genre: ["ãƒãƒƒãƒ—", "R&B"],
        bpm: "97 BPM",
        lyrics: "ã¾ãŸåƒ•ã‚‰ã§ã„ã‚ˆã† â€” Letâ€™s be us again",
        youtube: "https://www.youtube.com/embed/szzFlbMfFJY"
      },
      {
        title: "Home - SEVENTEEN",
        score: 70,
        genre: ["ãƒãƒƒãƒ—", "ãƒãƒ©ãƒ¼ãƒ‰"],
        bpm: "115 BPM",
        lyrics: "å›ã¯åƒ•ã®ãƒ›ãƒ¼ãƒ  â€” You are my home",
        youtube: "https://www.youtube.com/embed/f6YvyjK0b9o"
      },
      {
        title: "Darl+ing - SEVENTEEN",
        score: 75,
        genre: ["ãƒãƒƒãƒ—"],
        bpm: "118 BPM",
        lyrics: "å›ã¨åƒ•ã€äºŒäººã§ã²ã¨ã¤ â€” You and I, we are one",
        youtube: "https://www.youtube.com/embed/bTtNV6hgDno"
      },
      {
        title: "Falling Flower - SEVENTEEN",
        score: 80,
        genre: ["ãƒãƒ©ãƒ¼ãƒ‰", "ãƒãƒƒãƒ—"],
        bpm: "123 BPM",
        lyrics: "èŠ±ã³ã‚‰ãŒèˆã„è½ã¡ã‚‹ã‚ˆã†ã« â€” Like a falling flower",
        youtube: "https://www.youtube.com/embed/0OuD6UQGLcU"
      },
      {
        title: "Thanks - SEVENTEEN",
        score: 85,
        genre: ["ãƒ€ãƒ³ã‚¹", "ãƒ­ãƒƒã‚¯"],
        bpm: "121 BPM",
        lyrics: "æ„Ÿè¬ã®æ°—æŒã¡ã¯è¨€è‘‰ã˜ã‚ƒè¶³ã‚Šãªã„ â€” Words arenâ€™t enough for my thanks",
        youtube: "https://www.youtube.com/embed/VCDWg0ljbFQ"
      },
      {
        title: "Rock With You - SEVENTEEN",
        score: 90,
        genre: ["ãƒ­ãƒƒã‚¯", "ãƒ€ãƒ³ã‚¹"],
        bpm: "130 BPM",
        lyrics: "å›ã¨ãªã‚‰ã©ã“ã¾ã§ã‚‚è¡Œã‘ã‚‹ â€” I can go anywhere with you",
        youtube: "https://www.youtube.com/embed/WpuatuzSDK4"
      },
      {
        title: "One and Only - BOYNEXTDOOR",
        score: 12,
        genre: ["ãƒãƒƒãƒ—", "R&B"],
        bpm: "98 BPM",
        lyrics: "ë„ˆë§Œ ë³´ë©´ ì›ƒê²Œ ë¼ â€” å›ã‚’è¦‹ã‚‹ã ã‘ã§ç¬‘é¡”ã«ãªã‚‹",
        youtube: "https://www.youtube.com/embed/Abp0gOw0jzY"
      },
      {
        title: "Sugar Rush Ride - TXT",
        score: 22,
        genre: ["ãƒ€ãƒ³ã‚¹", "ãƒãƒƒãƒ—"],
        bpm: "105 BPM",
        lyrics: "ë‹¬ì½¤í•œ ì¤‘ë…ì´ì•¼ â€” ç”˜ã„ä¸­æ¯’ã ",
        youtube: "https://www.youtube.com/embed/NMNmj7ZLZGg"
      },
      {
        title: "In Bloom - ZB1",
        score: 18,
        genre: ["ãƒãƒƒãƒ—"],
        bpm: "110 BPM",
        lyrics: "í”¼ì–´ë‚˜ ë‹¤ì‹œ íƒœì–´ë‚˜ â€” å’²ã„ã¦ã‚‚ã†ä¸€åº¦ç”Ÿã¾ã‚Œã‚‹",
        youtube: "https://www.youtube.com/embed/trzeUClQIIg"
      },
      {
        title: "Time of Our Life - DAY6",
        score: 50,
        genre: ["ãƒ­ãƒƒã‚¯", "ãƒãƒƒãƒ—"],
        bpm: "130 BPM",
        lyrics: "ì§€ê¸ˆ ì´ ìˆœê°„ì´ ìš°ë¦¬ì˜ ì‹œê°„ â€” ä»Šã“ã®ç¬é–“ãŒåƒ•ã‚‰ã®æ™‚é–“",
        youtube: "https://www.youtube.com/embed/vnS_jn2uibs"
      },
      {
        title: "Flare - LUCY",
        score: 45,
        genre: ["ãƒ­ãƒƒã‚¯"],
        bpm: "115 BPM",
        lyrics: "ìš°ë¦° ì„œë¡œì˜ ë¹› â€” åƒ•ã‚‰ã¯ãŠäº’ã„ã®å…‰",
        youtube: "https://www.youtube.com/embed/lJhOJ02yFhM"
      },
      {
        title: "Universe (Let's Play Ball) - NCT U",
        score: 70,
        genre: ["ã‚¨ãƒ¬ã‚¯ãƒˆãƒ­", "ãƒ€ãƒ³ã‚¹"],
        bpm: "125 BPM",
        lyrics: "ìš°ë¦° ëì—†ì´ ë‹¬ë ¤ â€” åƒ•ã‚‰ã¯æœã¦ã—ãªãèµ°ã‚‹",
        youtube: "https://www.youtube.com/embed/GZbRLZ6N4Z4"
      },
      {
        title: "Guerrilla - ATEEZ",
        score: 90,
        genre: ["ãƒ­ãƒƒã‚¯", "ã‚¨ãƒ¬ã‚¯ãƒˆãƒ­"],
        bpm: "150 BPM",
        lyrics: "ìš°ë¦° ì„¸ìƒì„ ë°”ê¿” â€” åƒ•ã‚‰ã¯ä¸–ç•Œã‚’å¤‰ãˆã‚‹",
        youtube: "https://www.youtube.com/embed/hzRg_HNVFb8"
      },
      {
        title: "Love Love Love - Epik High",
        score: 40,
        genre: ["ãƒ’ãƒƒãƒ—ãƒ›ãƒƒãƒ—"],
        bpm: "94 BPM",
        lyrics: "ì‚¬ë‘ì€ ì•„í”„ë‹¤ â€” æ„›ã¯ç—›ã„",
        youtube: "https://www.youtube.com/embed/6QFwo57WKwg"
      },
      {
        title: "BAAAM - Dynamic Duo",
        score: 75,
        genre: ["ãƒ’ãƒƒãƒ—ãƒ›ãƒƒãƒ—"],
        bpm: "135 BPM",
        lyrics: "ë°¤ìƒˆìš°ê²Œ í•´ ë„ â€” å›ã®ã›ã„ã§ä¸€æ™©ä¸­çœ ã‚Œãªã„",
        youtube: "https://www.youtube.com/embed/Ut5tqXcHRMI"
      },
      {
        title: "Spring Day - BTS",
        score: 15,
        genre: ["ãƒãƒ©ãƒ¼ãƒ‰", "ãƒãƒƒãƒ—"],
        bpm: "105 BPM",
        lyrics: "ë³´ê³  ì‹¶ë‹¤ â€” ä¼šã„ãŸã„",
        youtube: "https://www.youtube.com/embed/xEeFrLSkMm8"
      },
      {
        title: "I'm Sorry - CNBLUE",
        score: 20,
        genre: ["ãƒ­ãƒƒã‚¯"],
        bpm: "110 BPM",
        lyrics: "ì •ë§ ë¯¸ì•ˆí•´ â€” æœ¬å½“ã«ã”ã‚ã‚“",
        youtube: "https://www.youtube.com/embed/T9cZpNe4pxg"
      },
      {
        title: "Love in the Ice - æ±æ–¹ç¥èµ·",
        score: 30,
        genre: ["ãƒãƒ©ãƒ¼ãƒ‰"],
        bpm: "90 BPM",
        lyrics: "æ„›ã‚’ä¿¡ã˜ãŸã„ â€” æ„›ã‚’ä¿¡ã˜ãŸã„",
        youtube: "https://www.youtube.com/embed/C3EJrkJQmCY"
      },
      {
        title: "View - SHINee",
        score: 60,
        genre: ["ã‚¨ãƒ¬ã‚¯ãƒˆãƒ­", "ãƒãƒƒãƒ—"],
        bpm: "115 BPM",
        lyrics: "ì´ ëª¨ë“  ê°ì •ì€ ë„ í–¥í•´ â€” ã“ã®ã™ã¹ã¦ã®æ„Ÿæƒ…ã¯å›ã¸å‘ã‹ã£ã¦ã‚‹",
        youtube: "https://www.youtube.com/embed/UF53cptEE5k"
      },
      {
        title: "Sorry Sorry - SUPER JUNIOR",
        score: 72,
        genre: ["ãƒ€ãƒ³ã‚¹", "ãƒãƒƒãƒ—"],
        bpm: "130 BPM",
        lyrics: "Sorry, sorry, sorry, sorry â€” ã”ã‚ã‚“ã€ã”ã‚ã‚“ã€ã”ã‚ã‚“ã€ã”ã‚ã‚“",
        youtube: "https://www.youtube.com/embed/x6QA3m58DQw"
      },
      {
        title: "Get A Guitar - RIIZE",
        score: 55,
        genre: ["ãƒ­ãƒƒã‚¯", "ãƒ€ãƒ³ã‚¹"],
        bpm: "120 BPM",
        lyrics: "ê¸°íƒ€ í•˜ë‚˜ë¡œ ì‹œì‘ëœ ìš°ë¦¬ â€” ã‚®ã‚¿ãƒ¼ã²ã¨ã¤ã§å§‹ã¾ã£ãŸåƒ•ã‚‰",
        youtube: "https://www.youtube.com/embed/tEb1QRu0guQ"
      },
      {
        title: "Polaroid Love - ENHYPEN",
        score: 34,
        genre: ["ãƒãƒƒãƒ—"],
        bpm: "100 BPM",
        lyrics: "ì´ìƒí•˜ê²Œ ëŒë ¤ â€” ãªãœã‹æƒ¹ã‹ã‚Œã¦ã—ã¾ã†",
        youtube: "https://www.youtube.com/embed/kQlzjqZTnbE"
      }
    ];

    let selectedFeelings = [];
    let selectedGenre = null;

    // æ„Ÿæƒ…ã®é¸æŠ(æœ€å¤§2ã¤)
    function selectFeeling(btn, feeling) {
      const idx = selectedFeelings.indexOf(feeling);
      if (idx !== -1) {
        selectedFeelings.splice(idx, 1);
        btn.classList.remove("selected");
      } else {
        if (selectedFeelings.length >= 2) {
          btn.classList.add("shake");
          setTimeout(() => btn.classList.remove("shake"), 350);
          alert("æ°—åˆ†ã¯æœ€å¤§2ã¤ã¾ã§é¸ã¹ã¾ã™ã€‚");
          return;
        }
        selectedFeelings.push(feeling);
        btn.classList.add("selected");
      }
      document.getElementById("result").style.display = "none";
    }
    // ã‚¸ãƒ£ãƒ³ãƒ«ã®é¸æŠ(æœ€å¤§1ã¤)
    function selectGenre(btn, genre) {
      if (selectedGenre === genre) {
        selectedGenre = null;
        btn.classList.remove("selected");
      } else {
        // æ—¢ã«ä»–ã®ã‚¸ãƒ£ãƒ³ãƒ«ãŒé¸æŠæ¸ˆã¿ãªã‚‰ã‚¢ãƒ©ãƒ¼ãƒˆ
        const prev = document.querySelector('#genres button.selected');
        if (prev) {
          prev.classList.remove("selected");
          if (prev === btn) return; // åŒã˜ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ãŸæ™‚ã¯return
        }
        selectedGenre = genre;
        btn.classList.add("selected");
      }
      document.getElementById("result").style.display = "none";
    }

    // ãƒœã‚¿ãƒ³é¸æŠçŠ¶æ…‹ãƒªã‚»ãƒƒãƒˆ
    function resetSelections() {
      selectedFeelings = [];
      selectedGenre = null;
      document.querySelectorAll('#feelings button.selected').forEach(btn => btn.classList.remove("selected"));
      document.querySelectorAll('#genres button.selected').forEach(btn => btn.classList.remove("selected"));
    }

    // ãŠã™ã™ã‚æ›²ã®é¸å®š
    function recommendSong() {
      if (selectedFeelings.length === 0 && !selectedGenre) {
        alert("æ°—åˆ†ã¾ãŸã¯ã‚¸ãƒ£ãƒ³ãƒ«ã‚’å°‘ãªãã¨ã‚‚1ã¤é¸æŠã—ã¦ãã ã•ã„ã€‚");
        return;
      }
      // æ„Ÿæƒ…ã®å¹³å‡ã‚¹ã‚³ã‚¢ç®—å‡º
      let avgScore = null;
      if (selectedFeelings.length > 0) {
        avgScore = selectedFeelings.map(f => emotionScores[f]).reduce((a, b) => a + b, 0) / selectedFeelings.length;
      }

      // ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
      let filteredSongs = songs;
      if (selectedGenre) {
        filteredSongs = filteredSongs.filter(song => song.genre.includes(selectedGenre));
      }
      // ã•ã‚‰ã«æ„Ÿæƒ…ãƒãƒƒãƒãƒ³ã‚°
      if (avgScore !== null) {
        let minDiff = Infinity, bestMatches = [];
        filteredSongs.forEach(song => {
          const diff = Math.abs(song.score - avgScore);
          if (diff < minDiff) {
            minDiff = diff;
            bestMatches = [song];
          } else if (diff === minDiff) {
            bestMatches.push(song);
          }
        });
        // ã‚¸ãƒ£ãƒ³ãƒ«ã§çµã£ãŸçµæœ0ä»¶ãªã‚‰å…¨æ›²ã‹ã‚‰æ„Ÿæƒ…ã ã‘ã§å†ãƒãƒƒãƒãƒ³ã‚°
        if (bestMatches.length === 0 && selectedGenre) {
          filteredSongs = songs;
          minDiff = Infinity; bestMatches = [];
          filteredSongs.forEach(song => {
            const diff = Math.abs(song.score - avgScore);
            if (diff < minDiff) {
              minDiff = diff;
              bestMatches = [song];
            } else if (diff === minDiff) {
              bestMatches.push(song);
            }
          });
        }
        filteredSongs = bestMatches;
      }

      // ã©ã¡ã‚‰ã‚‚é¸ã°ã‚Œã¦ã„ãªã„å ´åˆ
      if (filteredSongs.length === 0) {
        alert("ãŠã™ã™ã‚ã§ãã‚‹æ›²ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚åˆ¥ã®çµ„ã¿åˆã‚ã›ã§ãŠè©¦ã—ãã ã•ã„ã€‚");
        resetSelections();
        return;
      }
      const bestMatch = filteredSongs[Math.floor(Math.random() * filteredSongs.length)];
      if (bestMatch) {
        document.getElementById("title").innerText = bestMatch.title;
        document.getElementById("bpm").innerText = bestMatch.bpm;
        document.getElementById("lyrics").innerText = bestMatch.lyrics;
        document.getElementById("video").innerHTML =
          `<iframe width="100%" height="315" src="${bestMatch.youtube}" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>`;
        document.getElementById("result").style.display = "block";
      }
      resetSelections();
    }
  </script>
</body>
</html>